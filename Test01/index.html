<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" 
          rel="stylesheet" 
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" 
          crossorigin="anonymous">
    <!-- FancyBox CSS -->
    <link rel="stylesheet" href="resource/js/fancybox/jquery.fancybox.min.css">
    <!-- Main Stylesheets -->
    <link href="style.css" rel="stylesheet">
    <link href="normalize.css" rel="stylesheet">
    <!-- Icon Library -->
    <link href="resource/icon/fontawesome/css/all.css" rel="stylesheet">
    <title>KBY Creative</title>
  </head>


  <body>
    <!--Top Navigation Menu-->
    <nav class="navbar mb-5 navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">KBY CREATIVE</a>
        <button class="navbar-toggler" type="button" 
                data-bs-toggle="collapse" 
                data-bs-target="#navbarText" 
                aria-controls="navbarText" 
                aria-expanded="false" 
                aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarText">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">GALLERY</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">ABOUT</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">CONTACT</a>
            </li>
          </ul>
          <span class="navbar-text">
            Logo
          </span>
        </div>
      </div>
    </nav>

    <main>
      <section class="gallery">
        <div class="container">
          <div class="row">
            <div class="col-3">
              <div class="row">
                <h1>2021</h1>
                <p>WIP: test website for learning web dev</p>
                <p>
                  TO-DO:  
                  <ul>
                    <li>
                      Optimise for mobile viewports
                    </li>
                    <li>
                      About Page, Contact Page, Social media links
                    </li>
                    <li>
                      Firebase cloud function for backend
                    </li>
                    <li>
                      extract meta data from uploaded images
                    </li>
                  </ul>
                </p>
              </div>
              <div class="row">         
                <div class="UploadSection">
                    <!-- Button trigger modal -->
                    <div class="d-grid">
                        <button class="btn btn-primary" type="button" id="uploadButton" 
                                data-bs-toggle="modal" data-bs-target="#uploadModal">Upload</button>                  
                    </div>
                    <!-- Modal -->
                    <div class="modal fade" id="uploadModal" data-bs-backdrop="static" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="uploadModalLabel">Upload</h5>
                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">

                                <div class="authenticate" id="aform">
                                  <form>
                                    <label for="access-key" class="form-label">Key:</label>
                                    <input type="text" id="access-key" class="form-control" autocomplete="off" aria-describedby="passwordHelpBlock">
                                    <div id="passwordHelpBlock" id="helptext" class="form-text">     
                                                           
                                    </div>
                                    <button class="btn btn-primary" type="button" id="check-key" >Enter</button>                                  
                                  </form>
                                </div>

                                <div class="upload-section" id="uform">
                                  <!-- Progress Bar-->
                                  <div class="progress">
                                      <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                          role="progressbar"                                         
                                          style="width: 0%"
                                          aria-valuenow="0" 
                                          aria-valuemin="0" 
                                          aria-valuemax="100">
                                        </div>
                                  </div>
                                  <!-- Choose picture button-->
                                  <input type="file" id="file-selector" accept="image/*">
                                </div>
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                              <button type="button" id="confirm" class="btn btn-primary" disabled>Upload</button>
                            </div>
                          </div>
                        </div>
                    </div>
                </div>
                
              </div>
            </div>
            <div class="col-9">
              <div class="row">
                <h1>Gallery</h1>
              </div>
              <div class="row" id="gallery">
                <div class="col-6 col-lg-4 column">
                  <figure class="mb-4">
                    <a href="resource/image/01.jpg" data-fancybox="image" data-caption="Caption goes here">
                      <img src="resource/image/01.jpg" alt="" />
                    </a>
                  </figure>
                  <figure class="mb-4">
                    <a href="resource/image/02.jpg" data-fancybox="image" data-caption="">
                      <img src="resource/image/02.jpg" alt="" />
                    </a>
                  </figure>
                </div>
                <div class="col-6 col-lg-4 column">
                  <figure class="mb-4">
                    <a href="resource/image/03.jpg" data-fancybox="image" data-caption="">
                      <img src="resource/image/03.jpg" alt="" />
                    </a>
                  </figure>
                  <figure class="mb-4">
                    <a href="resource/image/05.jpg" data-fancybox="image" data-caption="">
                      <img src="resource/image/05.jpg" alt="" />
                    </a>
                  </figure>
                  <figure class="mb-4">
                    <a href="resource/image/06.jpg" data-fancybox="image" data-caption="">
                      <img src="resource/image/06.jpg" alt="" />
                    </a>
                  </figure>
                </div>
                <div class="col-6 col-lg-4 column">
                  <figure class="mb-4">
                    <a href="resource/image/cat.gif" data-fancybox="image" data-caption="">
                      <img src="resource/image/cat.gif" alt="" />
                    </a>
                  </figure>
                  <figure class="mb-4">
                    <a href="resource/image/07.jpg" data-fancybox="image" data-caption="">
                      <img src="resource/image/07.jpg" alt="" />
                    </a>
                  </figure>
                </div>
              </div>
            </div>
          </div>
        </div>
    </section>
    </main>

    <!--Footer Social Media Icons-->
    <nav class="navbar navbar-expand navbar-light bg-light">
      <div class="container">
        <div class="navbar">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a href="#facebookicon" class="nav-link"><i class="fab fa-facebook fa-lg"></i></a>
            </li>
            <li class="nav-item">
              <a href="#instagramicon" class="nav-link"><i class="fab fa-instagram fa-lg"></i></a>
            </li>
            <li class="nav-item">
              <a href="#linkedin" class="nav-link"><i class="fab fa-linkedin fa-lg"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </nav>




    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.2.5/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
     <script src="https://www.gstatic.com/firebasejs/8.2.5/firebase-storage.js"></script>

    <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyBLAxwu3xIK7LfFMP9GAvTUp5OuRvzEmtw",
        authDomain: "gallery-96670.firebaseapp.com",
        databaseURL: "https://gallery-96670-default-rtdb.firebaseio.com",
        projectId: "gallery-96670",
        storageBucket: "gallery-96670.appspot.com",
        messagingSenderId: "117779600584",
        appId: "1:117779600584:web:3fcb7c610447b534c601fd",
        storageBucket: 'gs://gallery-96670.appspot.com'
    };
    // Initialize Firebase  
    firebase.initializeApp(firebaseConfig);



    // UPLOADING IMAGES 
    // var progressBar = document.getElementById("progressBar");
    var fileButton = document.getElementById("file-selector");
    var confirm = document.getElementById("confirm");
    var photo;
    // Listen for File Selection
    fileButton.addEventListener('change', selectFile, false);
    function selectFile(){
      photo = this.files[0];
      //If a file is selected, make upload button available
      if (photo != null){
        confirm.removeAttribute("disabled");
      }
    }
    // Listen for file upload confirm
    confirm.addEventListener('click', confirmUpload);
    function confirmUpload(){
      // Storage reference
      imageRef = firebase.storage().ref('image/' + photo.name);
      // Upload
      var task = imageRef.put(photo);
      // Update progress bar
      task.on('state_changed', 
        function progress(snapshot){
          var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
          var progressBar = $('.progress-bar');
          progressBar.css('width', percentage + '%');
          progressBar.attr('aria-valuenow', percentage);
        },
        function error(err){
          console.log('An error occured while uploading.');

          //What if the image names are the same?
        },
        function complete(refreshIntervalID){
          console.log("Image uploaded successfully");

          // TO-DO DATABASE WORK, RENAME AND ADD IMAGE TO GALLERY, ADD METADATA TO FANCYBOX
          




          //Refresh Page
          location.reload();
        }
      );
    }
    </script>

    <!-- Bootstrap 5 JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" 
            crossorigin="anonymous"></script>
    <!-- Jquery 3-->
    <script src ="resource/js/jquery/jquery-3.5.1.min.js"></script>
    <!-- FancyBox JS-->
    <script src="resource/js/fancybox/jquery.fancybox.min.js"></script>
    <!-- Edit FancyBox Properties -->
    <script>
      $('[data-fancybox]').fancybox({
        loop: true,
        buttons: [
        //"zoom",
        //"share",
        //"slideShow",
        //"fullScreen",
        //"download",
        "thumbs",
        "close"
        ]
      })
    </script>
    <!-- Key checker-->
    <script src="resource/js/keyCheck.js"></script>

    <!-- <script type="module" src="resource/js/addPhoto.js"></script> -->

  </body>
</html>